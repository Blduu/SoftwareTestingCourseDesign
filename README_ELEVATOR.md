# 电梯实时监测系统

## 系统概述

电梯实时监测系统是PropSmart物业管理平台的一个重要组成部分，用于实时监控电梯运行状态，及时发现并处理异常情况，确保电梯安全运行。

## 主要功能

1. **电梯实时数据监测**
   - 实时采集电梯运行参数（楼层、方向、速度、温度等）
   - 数据可视化展示
   - 异常情况自动预警

2. **电梯异常处理**
   - 异常记录与分类
   - 异常处理流程管理
   - 处理结果追踪
   - 异常状态统计与分析

3. **电梯维护管理**
   - 电梯维护记录
   - 维护提醒
   - 维护后状态恢复
   - 自动处理相关异常记录

4. **电梯配置管理**
   - 电梯运行参数阈值配置
   - 预警规则设置

## 优化的数据模拟与维护流程

系统对电梯数据模拟和维护流程进行了优化：

1. **基于状态的数据模拟**
   - 故障和维护中的电梯将停止数据模拟
   - 只有解决了严重异常的电梯才能恢复正常运行
   - 电梯状态变化会记录在日志中

2. **自动异常处理**
   - 当电梯进行维护后，系统会自动将未解决的异常标记为已解决
   - 系统自动记录维护历史和解决的异常数量
   - 维护后电梯自动恢复为正常状态

3. **异常级别响应**
   - 严重异常：电梯立即停止运行，需要维修
   - 中等异常：电梯进入预警状态，但可以继续运行
   - 轻微异常：记录异常，不影响正常运行

## 用户权限

- **普通用户**：只能查看电梯基本信息（电梯ID、编号、安装日期、维护时间、当前状态）
- **管理员**：可查看全部信息，处理异常，进行维护，修改配置

## 数据模拟器

系统内置电梯数据模拟器，用于模拟电梯传感器实时数据：

- 自动生成电梯运行数据（位置、速度、温度等）
- 随机模拟异常情况
- 根据配置的阈值自动判断是否异常
- 异常情况自动记录并改变电梯状态
- 根据电梯状态决定是否继续产生数据

## API接口

### 电梯基本信息

- `GET /elevator/list/basic` - 获取所有电梯基本信息（用户视图）
- `GET /elevator/basic/{id}` - 获取指定电梯基本信息（用户视图）
- `GET /elevator/list/detail` - 获取所有电梯详细信息（管理员视图）
- `GET /elevator/detail/{id}` - 获取指定电梯详细信息（管理员视图）

### 电梯维护

- `POST /elevator/maintenance/{id}` - 更新电梯维护日期（管理员操作）
- `GET /elevator/maintenance/needed` - 获取所有需要维护的电梯（管理员视图）

### 电梯配置

- `GET /elevator/config/{id}` - 获取电梯配置信息（管理员视图）
- `POST /elevator/config/update` - 更新电梯配置（管理员操作）

### 电梯异常管理

- `GET /elevator/abnormality/list` - 获取所有电梯异常记录（管理员视图）
- `GET /elevator/abnormality/list/{elevatorId}` - 获取指定电梯的异常记录（管理员视图）
- `POST /elevator/abnormality/handle/{id}` - 处理电梯异常（管理员操作）
- `POST /elevator/abnormality/close/{id}` - 关闭电梯异常（管理员操作）
- `GET /elevator/abnormality/unresolved` - 获取所有未解决的电梯异常（管理员视图）
- `GET /elevator/abnormality/stats` - 获取电梯异常统计数据（管理员视图）

### 数据模拟器控制

- `POST /elevator/simulator/start` - 启动电梯数据模拟器（管理员操作）
- `POST /elevator/simulator/stop` - 停止电梯数据模拟器（管理员操作）

## 技术架构

- **后端**: Spring Boot + MyBatis-Plus
- **数据库**: MySQL
- **实时数据模拟**: 定时任务 + 随机数据生成
- **异常处理**: 事件驱动 + 状态机

## 异常类型与处理流程

1. **轻微异常**: 记录但不影响电梯运行状态
2. **中等异常**: 电梯状态变为预警，需要管理员处理
3. **严重异常**: 电梯状态变为故障，需要立即处理并维护，电梯停止运行 